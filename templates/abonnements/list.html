{% extends 'base.html' %} {% block content %}
{% load humanize %}

<h2 class="mb-4">{{ titre }}</h2>

<a href="{% url 'abonnement_create' %}" class="btn btn-primary mb-4"
  >Ajouter un abonnement</a
>

{% if abonnements %}
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>#</th>
        <th>Véhicule</th>
        <th>Date début</th>
        <th>Date fin</th>
        <th>Type</th>
        <th>Montant</th>
        <th>Actif ?</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for abonnement in abonnements %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ abonnement.vehicule }}</td>
        <td>{{ abonnement.date_debut|date:"j F Y" }}</td>
        <td>{{ abonnement.date_fin|date:"j F Y" }}</td>
        <td>{{ abonnement.type.type }}</td>
        <td>{{ abonnement.montant|floatformat:0|intcomma }}</td>
        <td>
          {% if abonnement.actif %}
            <span class="text-success">
              ✅ Oui
            </span>
          {% else %}
            <span class="text-danger">
              ❌ Non
            </span>
          {% endif %}
        </td>
        <td>
          <a
            href="{% url 'abonnement_detail' abonnement.pk %}"
            class="btn btn-sm btn-outline-info"
            >Voir</a
          >
          {% if abonnement.paiement %}
            <a
              href="{% url 'paiement_list_par_abonnement' abonnement.pk %}"
              class="btn btn-sm btn-outline-danger"
              >Paiements</a
            >
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

    {% if page_obj.paginator.num_pages > 1 %}
 
    <nav>
      <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Précédent</a>
          </li>
        {% else %}
          <li class="page-item disabled">
            <span class="page-link">Précédent</span>
          </li>
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
          {% if page_obj.number == num %}
            <li class="page-item active">
              <span class="page-link">{{ num }}</span>
            </li>
          {% else %}
            <li class="page-item">
              <a class="page-link" href="?page={{ num }}">{{ num }}</a>
            </li>
          {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Suivant</a>
          </li>
        {% else %}
          <li class="page-item disabled">
            <span class="page-link">Suivant</span>
          </li>
        {% endif %}
      </ul>
    </nav>
  {% endif %}
{% else %}
  <p>Aucun abonnement enregistré.</p>
{% endif %} {% endblock %}
